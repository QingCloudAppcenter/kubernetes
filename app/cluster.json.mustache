{
        "name": {{cluster.name}},
        "description": {{cluster.description}},
        "vxnet": {{cluster.vxnet}},
        "nodes": [
        {
            "role": "master",
            "container": {
                "type": "kvm",
                "image": "img-lyfw76bj",
                "zone": "pek3a"
            },
            "instance_class": {{cluster.master.instance_class}},
            "count": {{cluster.master.count}},
            "cpu": {{cluster.master.cpu}},
            "memory": {{cluster.master.memory}},
            "volume": {
                "size": {{cluster.master.volume_size}},
                "mount_point": "/data",
                "mount_options": "defaults,noatime",
                "filesystem": "ext4"
            },
            "services": {
                 "init": {
                    "order": 1,
                    "cmd": "/opt/kubernetes/script/init-master.sh"
                },
                "start": {
                    "order": 1,
                    "cmd": "/opt/kubernetes/script/start-master.sh"
                },
                "stop": {
                    "order": 1,
                    "cmd": "/opt/kubernetes/script/stop-master.sh",
                    "timeout": 300
                },
                "destroy": {
                    "order": 3,
                    "nodes_to_execute_on": 1,
                    "post_stop_service": true,
                    "cmd": "/opt/kubernetes/script/destroy-master.sh"
                },
                "update": {
                        "type": "custom",
                        "cmd": "/opt/kubernetes/image/update.sh",
                        "timeout": 86400
                }
            },
            "custom_metadata": {
                "cmd":"/opt/kubernetes/script/get-metadata.sh"
            },
            "health_check": {
                "enable": true,
                "interval_sec": 60,
                "timeout_sec": 10,
                "action_timeout_sec": 30,
                "healthy_threshold": 3,
                "unhealthy_threshold": 3,
                "check_cmd": "/opt/kubernetes/script/check-master.sh",
                "action_cmd": "/opt/kubernetes/script/restart-master.sh"
            },
            "advanced_actions": ["scale_horizontal"]
        },
        {
                    "role": "node",
                    "container": {
                        "type": "kvm",
                        "image": "img-lyfw76bj",
                        "zone": "pek3a"
                    },
                    "instance_class": {{cluster.node.instance_class}},
                    "count": {{cluster.node.count}},
                    "cpu": {{cluster.node.cpu}},
                    "memory": {{cluster.node.memory}},
                    "volume": {
                        "size": {{cluster.node.volume_size}},
                        "mount_point": "/data",
                        "mount_options": "defaults,noatime",
                        "filesystem": "ext4"
                    },
                    "vertical_scaling_policy": "sequential",
                    "services": {
                        "init": {
                            "order": 3,
                            "cmd": "/opt/kubernetes/script/init-node.sh"
                        },
                         "start": {
                             "order": 3,
                             "cmd": "/opt/kubernetes/script/start-node.sh"
                         },
                         "stop": {
                             "order": 3,
                             "cmd": "/opt/kubernetes/script/stop-node.sh"
                         },
                         "scale_in": {
                             "nodes_to_execute_on": 1,
                             "cmd": "/opt/kubernetes/script/scale-in.sh",
                             "timeout": 86400
                         },
                         "destroy": {
                            "order": 1,
                            "nodes_to_execute_on": 1,
                            "post_stop_service": false,
                            "cmd": "/opt/kubernetes/script/destroy-node.sh",
                            "timeout": 86400
                         },
                         "update": {
                                 "type": "custom",
                                 "cmd": "/opt/kubernetes/image/update.sh",
                                 "timeout": 86400
                         }
                    },
                    "health_check": {
                        "enable": true,
                        "interval_sec": 60,
                        "timeout_sec": 10,
                        "action_timeout_sec": 30,
                        "healthy_threshold": 3,
                        "unhealthy_threshold": 3,
                        "check_cmd": "/opt/kubernetes/script/check-node.sh",
                        "action_cmd": "/opt/kubernetes/script/restart-node.sh"
                    },
                    "advanced_actions": ["scale_horizontal"]
           },
           {
                    "role": "log",
                    "container": {
                        "type": "kvm",
                        "image": "img-lyfw76bj",
                        "zone": "pek3a"
                    },
                    "instance_class": {{cluster.log.instance_class}},
                    "count": {{cluster.log.count}},
                    "cpu": {{cluster.log.cpu}},
                    "memory": {{cluster.log.memory}},
                    "volume": {
                        "size": {{cluster.log.volume_size}},
                        "mount_point": "/data",
                        "mount_options": "defaults,noatime",
                        "filesystem": "ext4"
                    },
                    "vertical_scaling_policy": "sequential",
                    "services": {
                        "init": {
                            "order": 2,
                            "cmd": "/opt/kubernetes/script/init-node.sh"
                        },
                         "start": {
                             "order": 2,
                             "cmd": "/opt/kubernetes/script/start-node.sh"
                         },
                         "stop": {
                             "order": 2,
                             "cmd": "/opt/kubernetes/script/stop-node.sh"
                         },
                         "scale_in": {
                             "nodes_to_execute_on": 1,
                             "cmd": "/opt/kubernetes/script/scale-in.sh",
                             "timeout": 86400
                         },
                         "destroy": {
                            "order": 2,
                            "nodes_to_execute_on": 1,
                            "post_stop_service": false,
                            "cmd": "/opt/kubernetes/script/destroy-node.sh",
                            "timeout": 86400
                         },
                         "update": {
                                 "type": "custom",
                                 "cmd": "/opt/kubernetes/image/update.sh",
                                 "timeout": 86400
                         }
                    },
                    "health_check": {
                        "enable": true,
                        "interval_sec": 60,
                        "timeout_sec": 10,
                        "action_timeout_sec": 30,
                        "healthy_threshold": 3,
                        "unhealthy_threshold": 3,
                        "check_cmd": "/opt/kubernetes/script/check-node.sh",
                        "action_cmd": "/opt/kubernetes/script/restart-node.sh"
                    },
                    "advanced_actions": ["scale_horizontal"]
           },
            {
                        "role": "client",
                        "container": {
                            "type": "kvm",
                            "image": "img-wii78vlb",
                            "zone": "pek3a"
                        },
                        "instance_class": {{cluster.client.instance_class}},
                        "count": {{cluster.client.count}},
                        "cpu": {{cluster.client.cpu}},
                        "memory": {{cluster.client.memory}},
                        "user_access":true,
                        "services": {
                             "start": {
                                 "order": 2,
                                 "cmd": "/usr/bin/init_config.sh"
                             }
                        }
            }
        ],
        "env": {
            "access_key_id": {{env.access_key_id}},
            "secret_access_key": {{env.secret_access_key}},
            "cluster_domain": {{env.cluster_domain}},
            "api_external_domain": {{env.api_external_domain}},
            "insecure-registries": {{env.insecure-registries}},
            "pod_vxnets":{{env.pod_vxnets}},
            "dockerhub_username":{{env.dockerhub_username}},
            "dockerhub_password":{{env.dockerhub_password}},
            "keep_log_days":{{keep_log_days}}
        }
}
